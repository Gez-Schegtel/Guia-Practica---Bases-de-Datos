<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Ejercicios de la Unidad IV</title>
  <style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}

ul.task-list[class]{list-style: none;}
ul.task-list li input[type="checkbox"] {
font-size: inherit;
width: 0.8em;
margin: 0 0.8em 0.2em -1.6em;
vertical-align: middle;
}
</style>
  <style type="text/css">@font-face {
font-family: fira-sans;
src: local("FiraSans-Regular");
}
@font-face {
font-family: fira-mono;
src: local("FiraMono-Regular");
}
@font-face {
font-family: color-emoji;
src: local("Noto Color Emoji"), local("Apple Color Emoji"), local("Segoe UI Emoji"), local("Segoe UI Symbol");
}
:root {
--text-color: #24292e;
--background-color: #ffffff;
--alt-background-color: #f6f8fa;
--link-color: #0366d6;
--blockquote-text-color: #6a737d;
--blockquote-border-color: #dfe2e5;
--header-border-color: #eaecef;
--hr-background-color: #e1e4e8;
--table-tr-border-color: #c6cbd1;
--table-td-border-color: #dfe2e5;
--kbd-text-color: #444d56;
--kbd-background-color: #fafbfc;
--kbd-border-color: #c6cbd1;
--kbd-shadow-color: #959da5;
}
* {
box-sizing: border-box;
}
html {
font-size: 16px;
}
body {
color: var(--text-color);
background-color: var(--background-color);
font-family: "Fira Sans", fira-sans, sans-serif, color-emoji;
line-height: 1.5;
word-wrap: break-word;
max-width: 980px;
margin: auto;
margin-top: 60px;
padding: 4em;
}
@media screen and (max-width: 799px) {
html {
font-size: 14px;
}
body {
padding: 1em;
}
}
@media screen and (min-width: 1280px) {
html {
font-size: 18px;
}
}
a {
background-color: transparent;
color: var(--link-color);
text-decoration: none;
}
a:active,
a:hover {
outline-width: 0;
}
a:hover {
text-decoration: underline;
}
strong {
font-weight: 600;
}
img {
border-style: none;
}
hr {
box-sizing: content-box;
height: 0.25em;
padding: 0;
margin: 1.5em 0;
overflow: hidden;
background-color: var(--hr-background-color);
border: 0;
}
hr::before {
display: table;
content: "";
}
hr::after {
display: table;
clear: both;
content: "";
}
input {
font-family: inherit;
font-size: inherit;
line-height: inherit;
margin: 0;
overflow: visible;
}
[type="checkbox"] {
box-sizing: border-box;
padding: 0;
}
table {
border-spacing: 0;
border-collapse: collapse;
}
td,
th {
padding: 0;
}
h1,
h2,
h3,
h4,
h5,
h6 {
font-weight: 600;
margin: 0;
}
h1 {
font-size: 2em;
}
h2 {
font-size: 1.5em;
}
h3 {
font-size: 1.25em;
}
h4 {
font-size: 1em;
}
h5 {
font-size: 0.875em;
}
h6 {
font-size: 0.85em;
}
p {
margin-top: 0;
margin-bottom: 0.625em;
}
blockquote {
margin: 0;
}
ul,
ol {
padding-left: 0;
margin-top: 0;
margin-bottom: 0;
}
ol ol,
ul ol {
list-style-type: lower-roman;
}
ul ul ol,
ul ol ol,
ol ul ol,
ol ol ol {
list-style-type: lower-alpha;
}
dd {
margin-left: 0;
}
code,
kbd,
pre {
font-family: "Fira Mono", fira-mono, monospace, color-emoji;
font-size: 1em;
word-wrap: normal;
}
code {
border-radius: 0.1875em;
font-size: 0.85em;
padding: 0.2em 0.4em;
margin: 0;
}
pre {
margin-top: 0;
margin-bottom: 0;
font-size: 0.75em;
}
pre>code {
padding: 0;
margin: 0;
font-size: 1em;
word-break: normal;
white-space: pre;
background: transparent;
border: 0;
}
.highlight {
margin-bottom: 1em;
}
.highlight pre {
margin-bottom: 0;
word-break: normal;
}
.highlight pre,
pre {
padding: 1em;
overflow: auto;
font-size: 0.85em;
line-height: 1.5;
background-color: var(--alt-background-color);
border-radius: 0.1875em;
}
pre code {
background-color: transparent;
border: 0;
display: inline;
padding: 0;
margin: 0;
overflow: visible;
line-height: inherit;
word-wrap: normal;
}
.pl-0 {
padding-left: 0 !important;
}
.pl-1 {
padding-left: 0.25em !important;
}
.pl-2 {
padding-left: 0.5em !important;
}
.pl-3 {
padding-left: 1em !important;
}
.pl-4 {
padding-left: 1.5em !important;
}
.pl-5 {
padding-left: 2em !important;
}
.pl-6 {
padding-left: 2.5em !important;
}
.markdown-body::before {
display: table;
content: "";
}
.markdown-body::after {
display: table;
clear: both;
content: "";
}
.markdown-body>*:first-child {
margin-top: 0 !important;
}
.markdown-body>*:last-child {
margin-bottom: 0 !important;
}
a:not([href]) {
color: inherit;
text-decoration: none;
}
.anchor {
float: left;
padding-right: 0.25em;
margin-left: -1.25em;
line-height: 1;
}
.anchor:focus {
outline: none;
}
p,
blockquote,
ul,
ol,
dl,
table,
pre {
margin-top: 0;
margin-bottom: 1em;
}
blockquote {
padding: 0 1em;
color: var(--blockquote-text-color);
border-left: 0.25em solid var(--blockquote-border-color);
}
blockquote>:first-child {
margin-top: 0;
}
blockquote>:last-child {
margin-bottom: 0;
}
kbd {
display: inline-block;
padding: 0.1875em 0.3125em;
font-size: 0.6875em;
line-height: 1;
color: var(--kbd-text-color);
vertical-align: middle;
background-color: var(--kbd-background-color);
border: solid 1px var(--kbd-border-color);
border-bottom-color: var(--kbd-shadow-color);
border-radius: 3px;
box-shadow: inset 0 -1px 0 var(--kbd-shadow-color);;
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 1.5em;
margin-bottom: 1em;
font-weight: 600;
line-height: 1.25;
}
h1:hover .anchor,
h2:hover .anchor,
h3:hover .anchor,
h4:hover .anchor,
h5:hover .anchor,
h6:hover .anchor {
text-decoration: none;
}
h1 {
padding-bottom: 0.3em;
font-size: 2em;
border-bottom: 1px solid var(--header-border-color);
}
h2 {
padding-bottom: 0.3em;
font-size: 1.5em;
border-bottom: 1px solid var(--header-border-color);
}
h3 {
font-size: 1.25em;
}
h4 {
font-size: 1em;
}
h5 {
font-size: 0.875em;
}
h6 {
font-size: 0.85em;
opacity: 0.67;
}
ul,
ol {
padding-left: 2em;
}
ul ul,
ul ol,
ol ol,
ol ul {
margin-top: 0;
margin-bottom: 0;
}
li {
overflow-wrap: break-word;
}
li>p {
margin-top: 1em;
}
li+li {
margin-top: 0.25em;
}
dl {
padding: 0;
}
dl dt {
padding: 0;
margin-top: 1em;
font-size: 1em;
font-style: italic;
font-weight: 600;
}
dl dd {
padding: 0 1em;
margin-bottom: 1em;
}
table {
display: block;
width: 100%;
overflow: auto;
}
table th {
font-weight: 600;
}
table th,
table td {
padding: 0.375em 0.8125em;
border: 1px solid var(--table-td-border-color);
}
table tr {
background-color: var(--background-color);
border-top: 1px solid var(--table-tr-border-color);
}
table tr:nth-child(2n) {
background-color: var(--alt-background-color);
}
img {
max-width: 100%;
box-sizing: content-box;
}
img[align=right] {
padding-left: 1.25em;
}
img[align=left] {
padding-right: 1.25em;
}
.task-list-item {
list-style-type: none;
}
.task-list-item+.task-list-item {
margin-top: 0.1875em;
}
.task-list-item input {
margin: 0 0.2em 0.25em -1.6em;
vertical-align: middle;
}
:root {
--text-color: rgba(0, 0, 0, 0.8);
--background-color: #f5f5f5;
--alt-background-color: #eeeeee;
--link-color: #0d71de;
--blockquote-text-color: #747e85;
--blockquote-border-color: #d6d8da;
--header-border-color: #e1e2e4;
--hr-background-color: #d8dadd;
--table-tr-border-color: #bdc1c6;
--table-td-border-color: #d6d8da;
--kbd-text-color: #4e585e;
--kbd-background-color: #f1f1f1;
--kbd-border-color: #bdc1c6;
--kbd-shadow-color: #8c939a;
}
@media (prefers-color-scheme: dark) {
:root {
--text-color: #eeeeee;
--background-color: #282828;
--alt-background-color: #3a3a3a;
--link-color: #b5daff;
--blockquote-text-color: #a8a8a6;
--blockquote-border-color: #525252;
--header-border-color: #474747;
--hr-background-color: #505050;
--table-tr-border-color: #696969;
--table-td-border-color: #525252;
--kbd-text-color: #cececc;
--kbd-background-color: #3c3c3c;
--kbd-border-color: #696969;
--kbd-shadow-color: #979797;
}
}
</style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Ejercicios de la Unidad IV</h1>
</header>
<h2 id="ejercicio-5">Ejercicio 5</h2>
<p>Dado el siguiente esquema relacional:</p>
<ul>
<li>flights(flno: integer, origin: string, to: string, distance: integer, departs: time, arrives: time, cost: real)</li>
<li>certified(aid: integer, aname: string, cruisinrange: integer)</li>
<li>employees(eid: integer, aid: integer)</li>
<li>flights(eid: integer, ename: string, salary: real)</li>
</ul>
<p>Tener en cuenta que la relación <em>employees</em> describe tanto pilotos como otras clases de empleados; cada piloto está calificado para algún avión (de otra manera no podría calificar como piloto), y sólo los pilotos están calificados para volar.</p>
<p>Escribir las siguientes consultas en álgebra relacional. Tener en cuenta que no todas pueden ser contestadas. En tales casos explicar por qué.</p>
<ol type="1">
<li><p>Encuentre los eids de pilotos certificados para algún avión Boeing.</p>
<p>Opción 1:</p>
<pre><code> π eid (σ aname == &#39;Boeing 727&#39; (aircraft) ⋈ certified)</code></pre>
<p><em>Sin embargo, esta opción sólo toma los pilotos que están certificados para volar un Boeing 727.</em> <em>Para hacer más general la consulta, en Relational podemos hacer lo siguiente: </em></p>
<p>Opción 2:</p>
<pre><code> π eid (σ (aname.startswith(&quot;Boeing&quot;)) (aircraft) ⋈ certified)</code></pre>
<p><em>Esta consulta encuentra el eid de todos los pilotos que pueden volar aviones Boeing.</em></p></li>
<li><p>Encuentre los nombres de pilotos certificados para algún avión Boeing.</p>
<pre><code> π eid, ename (σ (aname.startswith(&quot;Boeing&quot;)) (aircraft) ⋈ certified ⋈ employees)</code></pre></li>
<li><p>Encuentre los aids de todos los aviones que pueden ser usados para vuelos sin paradas desde Los Ángeles hasta Sydney.</p>
<p><em>Voy a proyectar también el nombre del avión para que sea más fácil de controlar el ejercicio.</em></p>
<pre><code> π aid, aname(σ cruisingrange &gt; distance (aircraft * σ origin == &#39;Los Angeles&#39; and to == &#39;Sydney&#39; (flights)))</code></pre></li>
<li><p>Identifique los vuelos que pueden ser piloteados por cada piloto cuyo salario sea mayor a $260.000.</p>
<pre><code> aux1 = (σ salary &gt; 260000 (employees) ⋈ certified ⋈ aircraft)

 π flno, ename (σ cruisingrange &gt; distance (flights * aux1))</code></pre></li>
<li><p>Encuentre los nombres de pilotos que pueden operar aviones con un rango mayor a 3.000 km pero que NO esten certificados para los aviones Boeing.</p>
<pre><code> aux1 = employees ⋈ certified ⋈ σ cruisingrange &gt; 3000 (aircraft)

 aux2 = employees ⋈ certified ⋈ σ (aname.startswith(&quot;Boeing&quot;)) (aircraft)

 π ename (aux1) - π ename (aux2)</code></pre>
<p><em>En <strong>aux1</strong> obtenemos una relación con todos los pilotos que pueden volar aviones con una autonomía mayor a los 3000km, incluídos los Boeing; <strong>aux2</strong> es una tabla con pilotos que están certificados para volar aviones Boeing.</em></p>
<p><em>Al hacer una diferencia entre estas dos tablas, obtenemos una nueva tabla con pilotos que no están certificados para pilotar aviones Boeing pero sí pueden volar más de 3000km.</em></p></li>
<li><p>Encuentre los eids de empleados que ganan el mayor salario.</p>
<pre><code> aux = ρ eid ➡ eid_aux, ename ➡ ename_aux, salary ➡ salary_aux (employees)

 aux1 = π eid, ename, salary (σ eid != eid_aux and salary &lt; salary_aux (employees * aux))

 π ename, eid (employees - aux1)</code></pre>
<p><em>Primero, hacemos la tabla <strong>aux</strong> para poder hacer el producto cartesiano “entre sí” de la tabla <strong>employees</strong>. Luego, en <strong>aux1</strong> obtenemos una tabla donde se excluyó al empleado que gana el mayor salario. De esta manera, al hacer la diferencia con la tabla original, obtenemos el empleado que más gana al estar “eliminando” a todos los demás.</em></p>
<p><em>El nombre lo proyectamos para que sea más fácil comprobar el ejercicio.</em></p></li>
<li><p>Encuentre los eids de empleados que ganen el segundo mayor salario.</p>
<pre><code> aux = ρ eid ➡ eid_aux, ename ➡ ename_aux, salary ➡ salary_aux (employees)

 aux1 = π eid, ename, salary (σ eid != eid_aux and salary &lt; salary_aux (employees * aux))

 aux = ρ eid ➡ eid_aux, ename ➡ ename_aux, salary ➡ salary_aux (aux1)

 aux2 = π eid, ename, salary (σ eid != eid_aux and salary &lt; salary_aux (aux1 * aux))

 π ename, eid (aux1 - aux2)</code></pre>
<p><em>Este ejercicio sigue la misma lógica que el punto anterior, pero repitiendo el proceso una vez más: Digamos que de una tabla <strong>“A”</strong>, obtengo una tabla <strong>“B”</strong> que excluye a la persona que gane el mayor salario de la tabla <strong>“A”</strong>. Repito el proceso, pero esta vez de la tabla <strong>“B”</strong> obtengo una tabla <strong>“C”</strong> que excluye a la persona que gane el mayor salario de la tabla <strong>“B”</strong>.</em></p>
<p><em>Finalmente, la diferencia entre la tabla <strong>“B”</strong> con la <strong>“C”</strong>, nos devuelve la persona con el mayor salario de la tabla <strong>“B”</strong>, que a su vez es la persona con el segundo mejor salario en la tabla <strong>“A”</strong>, que es lo que se nos pide en el enunciado.</em></p></li>
<li><p>Encuentre los eids de empleados que están certificados para la mayor cantidad de aviones.</p>
<p>Este ejercicio no se puede resolver con las herramientas que nos brinda el álgebra relacional. Aunque el ejercicio pareciera ser similar al anterior, ahora tendríamos que comparar si el resultado de contar algo (la cantidad de aviones que un piloto puede pilotar) es mayor al resultado de contar otra cosa. <strong>Acumular o contar valores no lo podemos hacer</strong>. Nótese que en el ejercicio anterior podíamos comparar si un salario era mayor a otro porque era simplemente una cuestión de comparar dos valores numéricos “absolutos” almacenados de antemano en un campo de la tabla.</p></li>
<li><p>Encuentre los eids de los empleados que están certificados para exactamente 3 (tres) aviones.</p></li>
<li><p>Encuentre la cantidad total de dinero pagado en concepto de salario.</p>
<p>Para resolver este ejercicio tendríamos que sumar todos los salarios que aparecen en la tabla <strong>employees</strong>. Como sucedía en el ejericio 8, <strong>al no poder contar o acumular valores</strong> en el álgebra relacional, este ejercicio <strong>no se puede resolver</strong>.</p></li>
<li><p>¿Existe alguna secuencia de vuelos de Buenos Aires a Berlín Cada vuelo en la secuencia debe partir de la ciudad que es destino del vuelo anterior; el primer vuelo debe partir de Buenos Aires, el último debe llegar a Berlín y no hay restricción en la cantidad de vuelos intermedios. Su consulta debe determinar cuándo existe alguna secuencia de vuelos desde Buenos Aires a Berlín para alguna instancia de la relación Vuelos.</p>
<p>Al no estar determinada la cantidad de vuelos intermedios o escalas que tiene el vuelo este ejercicio <strong>no se puede resolver</strong>.</p>
<p>El en caso hipotético de que sí estuviese determinado este factor, al ejercicio se lo podría resolver haciendo muchas comparaciones (aunque pueda parecer tedioso). Sin estar determinado el número de paradas, no se puede hacer con las herramientas que tenemos de álgebra relacional.</p></li>
</ol>
</body>
</html>
